"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[116],{4116:function(e,a,r){r.r(a),r.d(a,{default:function(){return L}});var t=r(6540),s=r(6142),n=r(1338),c=r(423),o=r(8623),l=r(2828),d=r(42),u=r(6232),i=r(35),p=r(5701);const m=e=>e?.loginForm?.error,g=e=>e?.loginForm?.isLoading||!1,f=e=>e?.loginForm?.password||"",h=e=>e?.loginForm?.username||"";var x=r(38),j=r(5283),y=r(3276);const v=(0,x.zD)("login/loginByUsername",(async(e,a)=>{const{extra:r,dispatch:t,rejectWithValue:s}=a;try{const{data:a}=await r.api.post("/login",e);if(!a)throw new Error;return localStorage.setItem(y.Py,JSON.stringify(a)),t(j.Xp.setAuthData(a)),a}catch(e){return console.log(e),s("error")}})),N=(0,x.Z0)({name:"login",initialState:{username:"",password:"",isLoading:!1},reducers:{setUsername:(e,a)=>{e.username=a.payload},setPassword:(e,a)=>{e.password=a.payload}},extraReducers:e=>{e.addCase(v.pending,(e=>{e.isLoading=!0,e.error=void 0})).addCase(v.fulfilled,(e=>{e.isLoading=!1})).addCase(v.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload}))}}),{actions:w}=N,{reducer:C}=N;var E="PQPa1eB5",S=r(4848);const k={loginForm:C},F=e=>{const{className:a,onSuccess:r}=e,{t:x}=(0,s.B)(),j=(0,l.j)(),y=(0,n.d4)(h),N=(0,n.d4)(f),C=(0,n.d4)(m),F=(0,n.d4)(g),L=(0,t.useCallback)((e=>{j(w.setUsername(e))}),[j]),O=(0,t.useCallback)((e=>{j(w.setPassword(e))}),[j]),b=(0,t.useCallback)((async()=>{try{"fulfilled"===(await j(v({username:y,password:N}))).meta.requestStatus&&r&&r()}catch(e){console.error("Dispatch failed",e)}}),[j,N,y,r]);return(0,S.jsx)(o.H,{reducers:k,children:(0,S.jsxs)(i.T,{className:(0,c.x)("xYNEfcE9",{},[a]),children:[(0,S.jsx)(p.EY,{title:"Форма авторизации"}),C&&(0,S.jsx)(p.EY,{text:C,theme:p.$G.ERROR}),(0,S.jsx)(u.p,{autofocus:!0,placeholder:"Имя пользователя",className:E,value:y,onChange:L}),(0,S.jsx)(u.p,{placeholder:"Пароль",className:E,value:N,onChange:O}),(0,S.jsx)(d.$n,{onClick:b,theme:d.Ox.OUTLINE,className:"Ok_5amJo",disabled:F,children:x("Войти")})]})})};var L=(0,t.memo)(F)},6232:function(e,a,r){r.d(a,{p:function(){return l}});var t=r(6540),s=r(423),n=r(35),c={input:"LVdIPwcx",caretWrapper:"y1GiFC_L",caret:"lqMFGBuL",readonly:"fTN1PnWu"},o=r(4848);const l=e=>{const{className:a,value:r="",onChange:l,placeholder:d,type:u="text",autofocus:i,readonly:p,"data-testid":m="Input",...g}=e,f=(0,t.useRef)(),[h,x]=(0,t.useState)(!1),[j,y]=(0,t.useState)(r?.length),v=h&&!p;return(0,t.useEffect)((()=>{i&&(x(!0),f.current.focus())}),[i]),(0,o.jsxs)(n.z,{gap:"4",className:(0,s.x)("",{[c.readonly]:p},[a]),children:[d&&(0,o.jsx)("div",{className:c.placeholder,children:`${d}> `}),(0,o.jsxs)("div",{className:c.caretWrapper,children:[(0,o.jsx)("input",{ref:f,type:u,value:r,onChange:e=>{l?.(e.target.value),y(e.target.value.length)},className:c.input,onFocus:()=>{x(!0)},onBlur:()=>{x(!1)},onSelect:e=>{y(e?.target?.selectionStart||0)},readOnly:p,...g}),v&&(0,o.jsx)("span",{className:c.caret,style:{left:8.8*j+"px"}})]})]})}},8623:function(e,a,r){r.d(a,{H:function(){return c}});var t=r(6540),s=r(1338),n=r(4848);const c=e=>{const{children:a,reducers:r,removeAfterRemount:c=!0}=e,o=(0,s.wA)(),l=(0,s.Pj)();return(0,t.useEffect)((()=>{const e=l.reducerManager.getReducerMap();if(Object.entries(r).forEach((a=>{let[r,t]=a;r in e||(l.reducerManager.add(r,t),o({type:`@INIT ${r} reducer`}))})),c)return()=>{Object.entries(r).forEach((e=>{let[a]=e;l.reducerManager.remove(a),o({type:`@DESTROY ${a} reducer`})}))}}),[o,c,r,l.reducerManager]),(0,n.jsx)(n.Fragment,{children:a})}}}]);