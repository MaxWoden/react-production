"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[179],{1452:function(e,t,a){a.r(t),a.d(t,{default:function(){return re}});var r=a(6540),s=a(1338),c=a(4976),n=a(8623),l=a(2828),o=a(9991),i=a(35),d=a(5701),u=a(657),h=a(673);const g=e=>e.articlesPage?.error,v=e=>e.articlesPage?.isLoading,p=e=>e.articlesPage?._inited,m=e=>e.articlesPage?.page||1,x=e=>e.articlesPage?.view??h.Uv.LIST,C=e=>e.articlesPage?.sort??h.N9.VIEWS,y=e=>e.articlesPage?.order??"ASC",w=e=>e.articlesPage?.search??"",S=e=>e.articlesPage?.type??h.PF.ALL;var f=a(38),j=a(3276);const P=(0,f.zD)("articlesPage/fetchArticlesList",(async(e,t)=>{const{extra:a,rejectWithValue:r,getState:s}=t,c=(n=s(),n.articlesPage?.limit||4);var n;const l=S(s()),o=C(s()),i=y(s()),d=w(s()),u=m(s());try{h={sort:o,order:i,search:d,type:l},window.history.pushState(null,"",(e=>{const t=new URLSearchParams(window.location.search);return Object.entries(e).forEach((e=>{let[a,r]=e;void 0!==r&&t.set(a,r)})),`?${t.toString()}`})(h));const{data:e}=await a.api.get("/articles",{params:{q:d,type_like:l,_sort:o,_order:i,_page:u,_limit:c,_expand:"user"}});if(!e)throw new Error;return e}catch(e){return console.log(e),r("Произошла ошибка при загрузке данных")}var h})),N=(0,f.pU)({selectId:e=>e.id}),E=N.getSelectors((e=>e.articlesPage||N.getInitialState())),L=(0,f.Z0)({name:"articlesPage",initialState:N.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{},page:1,hasMore:!0,_inited:!1,limit:4,sort:h.N9.CREATED,search:"",order:"ASC",type:h.PF.ALL,view:h.Uv.LIST}),reducers:{setView:(e,t)=>{e.view=t.payload,localStorage.setItem(j.ll,t.payload),e.limit=t.payload===h.Uv.LIST?4:16},setPage:(e,t)=>{e.page=t.payload},setType:(e,t)=>{e.type=t.payload},setSearch:(e,t)=>{e.search=t.payload},setSort:(e,t)=>{e.sort=t.payload},setOrder:(e,t)=>{e.order=t.payload},initState:e=>{const t=localStorage.getItem(j.ll);e.view=t,e.limit=t===h.Uv.LIST?4:16,e._inited=!0}},extraReducers:e=>{e.addCase(P.pending,((e,t)=>{e.isLoading=!0,e.error=void 0,t.meta.arg.add||N.removeAll(e)})).addCase(P.fulfilled,((e,t)=>{e.isLoading=!1,e.hasMore=t.payload.length>=e.limit,t.meta.arg.add?N.addMany(e,t.payload):N.setAll(e,t.payload)})).addCase(P.rejected,((e,t)=>{e.isLoading=!1,e.error=t.payload}))}}),{actions:b,reducer:k}=L,T=(0,f.zD)("articlesPage/fetchNextArticlesPage",(async(e,t)=>{const{getState:a,dispatch:r}=t,s=(c=a(),c.articlesPage?.hasMore);var c;const n=v(a()),l=m(a());s&&!n&&(r(b.setPage(l+1)),r(P({add:!0})))})),I=(0,f.zD)("articlesPage/initArticlesPage",(async(e,t)=>{const{getState:a,dispatch:r}=t;if(!p(a())){const t=e.get("order"),a=e.get("sort"),s=e.get("type"),c=e.get("search");t&&r(b.setOrder(t)),a&&r(b.setSort(a)),s&&r(b.setType(s)),c&&r(b.setSearch(c)),r(b.initState()),r(P({}))}}));var A=a(6142),O=a(1836),R=a(6232),V=a(423),M=a(5857),z=a(4848);const _=(0,r.memo)((e=>{const{className:t,order:a,sort:s,onChangeOrder:c,onChangeSort:n}=e,{t:l}=(0,A.B)(),o=(0,r.useMemo)((()=>[{value:h.N9.VIEWS,content:l("популярности")},{value:h.N9.CREATED,content:l("дате создания")},{value:h.N9.TITLE,content:l("названию")}]),[l]),d=(0,r.useMemo)((()=>[{value:"DESC",content:l("по убыванию")},{value:"ASC",content:l("по возрастанию")}]),[l]);return(0,z.jsxs)(i.z,{gap:"32",className:(0,V.x)("",{},[t]),children:[(0,z.jsx)(M.l,{label:l("Сортировать по"),options:o,onSelect:n,value:s}),(0,z.jsx)(M.l,{label:l("↑↓"),options:d,onSelect:c,value:a})]})}));var B=a(3334),W={item:"YTdmRPCZ",clear:"kREYPwWz",selected:"ZhF6Sqyx",outline:"XK6pCBJ5"};let F=function(e){return e.CLEAR="clear",e.OUTLINE="outline",e}({});const U=e=>{const{className:t,tabs:a,value:s,onTabClick:c,theme:n=F.CLEAR}=e,[l,o]=(0,r.useState)(s),d=(0,r.useCallback)((e=>()=>{c(e.value),o(e.value)}),[c]),u=[t,W[n]];return(0,z.jsx)(i.z,{wrap:!0,gap:"16",className:(0,V.x)("",{},u),children:a.map((e=>(0,z.jsx)(B.Z,{onClick:d(e),className:(0,V.x)(W.item,{[W.selected]:l===e.value}),children:e.content},e.value)))})},D=(0,r.memo)((e=>{const{className:t,type:a,onChangeType:s}=e,{t:c}=(0,A.B)(),n=(0,r.useMemo)((()=>[{value:h.PF.ALL,content:c("Все статьи")},{value:h.PF.IT,content:c("Айти")},{value:h.PF.ECONOMICS,content:c("Экономика")},{value:h.PF.SCIENCE,content:c("Наука")}]),[c]);return(0,z.jsx)(U,{tabs:n,value:a,onTabClick:s,className:t})}));var H;function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},Z.apply(null,arguments)}var q;function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},G.apply(null,arguments)}var J=a(42),K=a(3377),X="yX5XN0V6";const Y=[{view:h.Uv.LIST,Icon:e=>r.createElement("svg",G({xmlns:"http://www.w3.org/2000/svg",width:800,height:800,viewBox:"0 0 18 18"},e),q||(q=r.createElement("g",{fillRule:"evenodd"},r.createElement("rect",{width:18,height:4,rx:2}),r.createElement("rect",{width:18,height:4,y:7,rx:2}),r.createElement("rect",{width:18,height:4,y:14,rx:2}))))},{view:h.Uv.GRID,Icon:e=>r.createElement("svg",Z({xmlns:"http://www.w3.org/2000/svg",width:800,height:800,viewBox:"0 -0.5 21 21"},e),H||(H=r.createElement("path",{fillRule:"evenodd",d:"M18.9 14h-2.1c-1.16 0-2.1.895-2.1 2v2c0 1.105.94 2 2.1 2h2.1c1.16 0 2.1-.895 2.1-2v-2c0-1.105-.94-2-2.1-2m-7.35 0h-2.1c-1.16 0-2.1.895-2.1 2v2c0 1.105.94 2 2.1 2h2.1c1.16 0 2.1-.895 2.1-2v-2c0-1.105-.94-2-2.1-2M4.2 14H2.1C.94 14 0 14.895 0 16v2c0 1.105.94 2 2.1 2h2.1c1.16 0 2.1-.895 2.1-2v-2c0-1.105-.94-2-2.1-2m14.7-7h-2.1c-1.16 0-2.1.895-2.1 2v2c0 1.105.94 2 2.1 2h2.1c1.16 0 2.1-.895 2.1-2V9c0-1.105-.94-2-2.1-2m-7.35 0h-2.1c-1.16 0-2.1.895-2.1 2v2c0 1.105.94 2 2.1 2h2.1c1.16 0 2.1-.895 2.1-2V9c0-1.105-.94-2-2.1-2M4.2 7H2.1C.94 7 0 7.895 0 9v2c0 1.105.94 2 2.1 2h2.1c1.16 0 2.1-.895 2.1-2V9c0-1.105-.94-2-2.1-2m14.7-7h-2.1c-1.16 0-2.1.895-2.1 2v2c0 1.105.94 2 2.1 2h2.1c1.16 0 2.1-.895 2.1-2V2c0-1.105-.94-2-2.1-2m-7.35 0h-2.1c-1.16 0-2.1.895-2.1 2v2c0 1.105.94 2 2.1 2h2.1c1.16 0 2.1-.895 2.1-2V2c0-1.105-.94-2-2.1-2M6.3 2v2c0 1.105-.94 2-2.1 2H2.1C.94 6 0 5.105 0 4V2C0 .895.94 0 2.1 0h2.1c1.16 0 2.1.895 2.1 2"})))}],$=(0,r.memo)((e=>{const{className:t,view:a,onViewClick:r}=e;return(0,z.jsx)(i.z,{gap:"8",className:(0,V.x)("",{},[t]),children:Y.map(((e,t)=>(0,z.jsx)(J.$n,{onClick:()=>r(e.view),children:(0,z.jsx)(K.I,{Svg:e.Icon,className:(0,V.x)("Je9LJb7W",{[X]:a===e.view})})},t)))})}));const Q=(0,r.memo)((()=>{const{t:e}=(0,A.B)(),t=(0,l.j)(),a=(0,s.d4)(x),c=(0,s.d4)(S),n=(0,s.d4)(C),o=(0,s.d4)(y),d=(0,s.d4)(w),u=(0,r.useCallback)((()=>t(P({}))),[t]),h=(e=>{const t=(0,r.useRef)();return(0,r.useCallback)((function(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];t.current&&clearTimeout(t.current),t.current=setTimeout((()=>{e(...r)}),500)}),[e,500])})((()=>{u()})),g=(0,r.useCallback)((e=>{t(b.setView(e)),t(b.setPage(1)),u()}),[t,u]),v=(0,r.useCallback)((e=>{t(b.setType(e)),t(b.setPage(1)),u()}),[t,u]),p=(0,r.useCallback)((e=>{t(b.setSort(e)),t(b.setPage(1)),u()}),[t,u]),m=(0,r.useCallback)((e=>{t(b.setOrder(e)),t(b.setPage(1)),u()}),[t,u]),f=(0,r.useCallback)((e=>{t(b.setSearch(e)),t(b.setPage(1)),h()}),[t,h]);return(0,z.jsxs)(i.T,{max:!0,gap:"16",children:[(0,z.jsxs)(i.z,{max:!0,justify:"between",children:[(0,z.jsx)(_,{order:o,sort:n,onChangeOrder:m,onChangeSort:p}),(0,z.jsx)($,{onViewClick:g,view:a})]}),(0,z.jsx)(O.Z,{className:"QkNSez8q",children:(0,z.jsx)(R.p,{value:d,onChange:f,placeholder:e("Поиск")})}),(0,z.jsx)(D,{type:c,onChangeType:v})]})})),ee=(0,r.memo)((e=>{const{className:t,onLoadNextPart:a}=e,r=(0,s.d4)(E.selectAll),c=(0,s.d4)(v),n=(0,s.d4)(x),l=(0,s.d4)(g);return(0,z.jsx)(h.R2,{virtualized:{Header:Q,onLoadNextPart:a},wrap:!0,className:t,isLoading:c,view:n,articles:r,error:Boolean(l)})})),te={articlesPage:k},ae=()=>{const e=(0,l.j)(),t=(0,s.d4)(g),a=(0,s.d4)(p),[h]=(0,c.ok)();(0,o.m)((()=>!a&&e(I(h))));const v=(0,r.useCallback)((()=>{e(T())}),[e]);return t?(0,z.jsx)(u.YW,{children:(0,z.jsx)(d.EY,{align:d.nO.CENTER,title:t})}):(0,z.jsx)(n.H,{removeAfterRemount:!1,reducers:te,children:(0,z.jsx)(i.T,{max:!0,children:(0,z.jsx)(ee,{onLoadNextPart:v})})})};var re=(0,r.memo)(ae)},5857:function(e,t,a){a.d(t,{l:function(){return o}});var r=a(6540),s=a(423),c="HaBgyfSK",n="rKHhU8sR",l=a(4848);const o=e=>{const{className:t,options:a,onSelect:o,label:i,value:d,readonly:u}=e,[h,g]=(0,r.useState)(!1),[v,p]=(0,r.useState)(a[0]);(0,r.useEffect)((()=>{d&&p(a.find((e=>e.value===d)))}),[d,a]),(0,r.useEffect)((()=>{u&&g(!1)}),[u]);const m=(0,r.useCallback)(((e,t)=>{e.stopPropagation(),o(t.value),p(t),g(!1)}),[o]),x=()=>{u||g((e=>!e))},C=(0,r.useMemo)((()=>a?.map((e=>(0,l.jsx)("li",{className:(0,s.x)("zZgj2JgW",{[n]:v.value===e.value}),onClick:t=>m(t,e),children:e.content},e.value)))),[a,v,m]);return(0,l.jsxs)("div",{className:(0,s.x)("eXu4wq7K",{[c]:u},[t]),children:[i&&(0,l.jsx)("span",{className:"G1uuf7Bp",children:`${i}>`}),(0,l.jsx)("div",{className:"t4ay1peO",onClick:x,children:v.content}),h&&(0,l.jsx)("ul",{className:"xWiG1Vj4",onClick:x,children:C})]})}},6232:function(e,t,a){a.d(t,{p:function(){return o}});var r=a(6540),s=a(423),c=a(35),n={input:"LVdIPwcx",caretWrapper:"y1GiFC_L",caret:"lqMFGBuL",readonly:"fTN1PnWu"},l=a(4848);const o=e=>{const{className:t,value:a="",onChange:o,placeholder:i,type:d="text",autofocus:u,readonly:h,"data-testid":g="Input",...v}=e,p=(0,r.useRef)(),[m,x]=(0,r.useState)(!1),[C,y]=(0,r.useState)(a?.length),w=m&&!h;return(0,r.useEffect)((()=>{u&&(x(!0),p.current.focus())}),[u]),(0,l.jsxs)(c.z,{gap:"4",className:(0,s.x)("",{[n.readonly]:h},[t]),children:[i&&(0,l.jsx)("div",{className:n.placeholder,children:`${i}> `}),(0,l.jsxs)("div",{className:n.caretWrapper,children:[(0,l.jsx)("input",{ref:p,type:d,value:a,onChange:e=>{o?.(e.target.value),y(e.target.value.length)},className:n.input,onFocus:()=>{x(!0)},onBlur:()=>{x(!1)},onSelect:e=>{y(e?.target?.selectionStart||0)},readOnly:h,...v}),w&&(0,l.jsx)("span",{className:n.caret,style:{left:8.8*C+"px"}})]})]})}}}]);