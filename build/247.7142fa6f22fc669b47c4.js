"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[247],{4092:function(e,a,n){var r,t=n(6540);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(null,arguments)}a.A=e=>t.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},e),r||(r=t.createElement("path",{fillRule:"evenodd",d:"m3.99 16.854-1.314 3.504a.75.75 0 0 0 .966.965l3.503-1.314a3 3 0 0 0 1.068-.687L18.36 9.175s-.354-1.061-1.414-2.122-2.122-1.414-2.122-1.414L4.677 15.786a3 3 0 0 0-.687 1.068m12.249-12.63 1.383-1.383c.248-.248.579-.406.925-.348.487.08 1.232.322 1.934 1.025.703.703.945 1.447 1.025 1.934.058.346-.1.677-.348.925L19.774 7.76s-.353-1.06-1.414-2.12c-1.06-1.062-2.121-1.415-2.121-1.415z",clipRule:"evenodd"})))},5857:function(e,a,n){n.d(a,{l:function(){return c}});var r=n(6540),t=n(423),l="HaBgyfSK",s="rKHhU8sR",o=n(4848);const c=e=>{const{className:a,options:n,onSelect:c,label:i,value:d,readonly:u}=e,[h,p]=(0,r.useState)(!1),[g,f]=(0,r.useState)(n[0]);(0,r.useEffect)((()=>{d&&f(n.find((e=>e.value===d)))}),[d,n]),(0,r.useEffect)((()=>{u&&p(!1)}),[u]);const m=(0,r.useCallback)(((e,a)=>{e.stopPropagation(),c(a.value),f(a),p(!1)}),[c]),C=()=>{u||p((e=>!e))},x=(0,r.useMemo)((()=>n?.map((e=>(0,o.jsx)("li",{className:(0,t.x)("zZgj2JgW",{[s]:g.value===e.value}),onClick:a=>m(a,e),children:e.content},e.value)))),[n,g,m]);return(0,o.jsxs)("div",{className:(0,t.x)("eXu4wq7K",{[l]:u},[a]),children:[i&&(0,o.jsx)("span",{className:"G1uuf7Bp",children:`${i}>`}),(0,o.jsx)("div",{className:"t4ay1peO",onClick:C,children:g.content}),h&&(0,o.jsx)("ul",{className:"xWiG1Vj4",onClick:C,children:x})]})}},6232:function(e,a,n){n.d(a,{p:function(){return c}});var r=n(6540),t=n(423),l=n(35),s={input:"LVdIPwcx",caretWrapper:"y1GiFC_L",caret:"lqMFGBuL",readonly:"fTN1PnWu"},o=n(4848);const c=e=>{const{className:a,value:n="",onChange:c,placeholder:i,type:d="text",autofocus:u,readonly:h,"data-testid":p="Input",...g}=e,f=(0,r.useRef)(),[m,C]=(0,r.useState)(!1),[x,v]=(0,r.useState)(n?.length),R=m&&!h;return(0,r.useEffect)((()=>{u&&(C(!0),f.current.focus())}),[u]),(0,o.jsxs)(l.z,{gap:"4",className:(0,t.x)("",{[s.readonly]:h},[a]),children:[i&&(0,o.jsx)("div",{className:s.placeholder,children:`${i}> `}),(0,o.jsxs)("div",{className:s.caretWrapper,children:[(0,o.jsx)("input",{ref:f,type:d,value:n,onChange:e=>{c?.(e.target.value),v(e.target.value.length)},className:s.input,onFocus:()=>{C(!0)},onBlur:()=>{C(!1)},onSelect:e=>{v(e?.target?.selectionStart||0)},readOnly:h,...g}),R&&(0,o.jsx)("span",{className:s.caret,style:{left:8.8*x+"px"}})]})]})}},7247:function(e,a,n){n.r(a),n.d(a,{default:function(){return ce}});let r=function(e){return e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR",e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_CITY="INCORRECT_CITY",e}({}),t=function(e){return e.RU="Russia",e.BY="Belarus",e.UA="Ukraine",e.AM="Armenia",e.KZ="Kazakhstan",e}({});var l=n(5857),s=n(6540),o=n(6142),c=n(4848);const i=[{value:t.AM,content:"Армения"},{value:t.BY,content:"Беларусь"},{value:t.KZ,content:"Казахстан"},{value:t.RU,content:"Россия"},{value:t.UA,content:"Украина"}],d=(0,s.memo)((e=>{const{className:a,readonly:n,value:r,onChange:t}=e,{t:d}=(0,o.B)(),u=(0,s.useCallback)((e=>{t?.(e)}),[t]);return(0,c.jsx)(l.l,{className:a,label:d("Укажите страну"),readonly:n,options:i,value:r,onSelect:u})}));let u=function(e){return e.USD="USD",e.EUR="EUR",e.RUB="RUB",e}({});const h=[{value:u.RUB,content:"Рубли"},{value:u.EUR,content:"Евро"},{value:u.USD,content:"Доллары"}],p=(0,s.memo)((e=>{const{className:a,readonly:n,value:r,onChange:t}=e,{t:i}=(0,o.B)(),d=(0,s.useCallback)((e=>{t?.(e)}),[t]);return(0,c.jsx)(l.l,{className:a,label:i("Укажите валюту"),readonly:n,options:h,value:r,onSelect:d})}));var g=n(423),f=n(2670),m=n(6232),C=n(7952),x=n(35),v=n(5701),R="wW9jgKKD",j="ZTyX8_n9",y="DjTe7269";const E=e=>{const{className:a,data:n,isLoading:r,error:t,readonly:l,onChangeFirstname:s,onChangeLastname:i,onChangeAge:u,onChangeCity:h,onChangeUsername:E,onChangeAvatar:N,onChangeCurrency:O,onChangeCountry:b}=e,{t:T}=(0,o.B)();if(r)return(0,c.jsx)(x.z,{max:!0,justify:"center",className:(0,g.x)(R,{},["t07ZxFGs",a]),children:(0,c.jsx)(C.a,{})});if(t)return(0,c.jsx)(x.z,{justify:"center",max:!0,className:(0,g.x)(R,{},["i5YK3SSb",a]),children:(0,c.jsx)(v.EY,{align:v.nO.CENTER,theme:v.$G.ERROR,title:T("Произошла ошибка при загрузке страницы"),text:T("Попробуйте обновить страницу")})});const S={[y]:!l};return(0,c.jsxs)(x.T,{align:"none",max:!0,gap:"16",className:(0,g.x)(R,S,[a]),children:[n?.avatar&&(0,c.jsx)(x.z,{justify:"center",children:(0,c.jsx)(f.e,{alt:"avatar",src:n?.avatar})}),(0,c.jsx)(m.p,{readonly:l,onChange:s,className:j,value:n?.firstname,placeholder:T("Ваше имя")}),(0,c.jsx)(m.p,{readonly:l,onChange:i,className:j,value:n?.lastname,placeholder:T("Ваша фамилия")}),(0,c.jsx)(m.p,{readonly:l,onChange:u,className:j,value:String(n?.age),placeholder:T("Ваш возраст")}),(0,c.jsx)(m.p,{readonly:l,onChange:h,className:j,value:n?.city,placeholder:T("Ваш город")}),(0,c.jsx)(m.p,{readonly:l,onChange:E,className:j,value:String(n?.username),placeholder:T("Ваше имя пользователя")}),(0,c.jsx)(m.p,{readonly:l,onChange:N,className:j,value:String(n?.avatar),placeholder:T("Введите ссылку на аватар")}),(0,c.jsx)(d,{readonly:l,value:n?.country,className:j,onChange:b}),(0,c.jsx)(p,{readonly:l,value:n?.currency,className:j,onChange:O})]})};var N=n(8623),O=n(2828),b=n(9991),T=n(1338);const S=e=>e?.profile?.data,w=e=>e?.profile?.error,A=e=>e?.profile?.form,_=e=>e?.profile?.isLoading,k=e=>e?.profile?.readonly,I=e=>e?.profile?.validateErrors;var L=n(569),U=n(38);const P=(0,U.zD)("profile/fetchProfileData",(async(e,a)=>{const{extra:n,rejectWithValue:r}=a;if(!e)return r("error");try{const{data:a}=await n.api.get((0,L.nL)(e));if(!a)throw new Error;return a}catch(e){return console.log(e),r("error")}})),B=(0,U.zD)("profile/updateProfileData",(async(e,a)=>{const{extra:n,rejectWithValue:t,getState:l}=a,s=A(l());s?.id||t([r.SERVER_ERROR]);const o=(e=>{if(!e)return[r.NO_DATA];const{firstname:a,lastname:n,age:t,city:l}=e,s=[];return a&&n||s.push(r.INCORRECT_USER_DATA),t&&Number.isInteger(t)||s.push(r.INCORRECT_AGE),l||s.push(r.INCORRECT_CITY),s})(s);if(o.length)return t(o);try{const{data:e}=await n.api.put(`/profile/${s?.id}`,s);if(!e)throw new Error;return e}catch(e){return console.log(e),t([r.SERVER_ERROR])}})),D=(0,U.Z0)({name:"profile",initialState:{data:void 0,isLoading:!1,error:void 0,readonly:!0},reducers:{setReadonly:(e,a)=>{e.readonly=a.payload},updateProfile:(e,a)=>{e.form={...e.form,...a.payload}},saveEdit:e=>{e.readonly=!0,e.data=e.form},cancelEdit:e=>{e.readonly=!0,e.form=e.data,e.validateErrors=void 0}},extraReducers:e=>{e.addCase(P.pending,(e=>{e.isLoading=!0,e.error=void 0})).addCase(P.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload})).addCase(P.rejected,((e,a)=>{e.isLoading=!1,e.readonly=!0,e.error=a.payload})).addCase(B.pending,(e=>{e.isLoading=!0,e.validateErrors=void 0})).addCase(B.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(B.rejected,((e,a)=>{e.isLoading=!1,e.readonly=!0,e.validateErrors=a.payload}))}}),{actions:z}=D,{reducer:Y}=D;var G,$=n(5283);function M(){return M=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M.apply(null,arguments)}var F,K=e=>s.createElement("svg",M({xmlns:"http://www.w3.org/2000/svg",width:800,height:800,viewBox:"0 0 512 512"},e),G||(G=s.createElement("path",{fillRule:"evenodd",d:"M420.48 121.813 390.187 91.52 256 225.92 121.813 91.52 91.52 121.813l134.4 134.188-134.4 134.186 30.293 30.293L256 286.08l134.187 134.4 30.293-30.293L286.08 256z"})));function V(){return V=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},V.apply(null,arguments)}var W=e=>s.createElement("svg",V({xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:800,height:800,viewBox:"0 0 492 492"},e),F||(F=s.createElement("path",{d:"m484.128 104.478-16.116-16.116c-5.064-5.068-11.816-7.856-19.024-7.856s-13.964 2.788-19.028 7.856L203.508 314.81 62.024 173.322c-5.064-5.06-11.82-7.852-19.028-7.852-7.204 0-13.956 2.792-19.024 7.852l-16.12 16.112C2.784 194.51 0 201.27 0 208.47c0 7.204 2.784 13.96 7.852 19.028l159.744 159.736c.212.3.436.58.696.836l16.12 15.852c5.064 5.048 11.82 7.572 19.084 7.572h.084c7.212 0 13.968-2.524 19.024-7.572l16.124-15.992c.26-.256.48-.468.612-.684l244.784-244.76c10.5-10.476 10.5-27.52.004-38.008"}))),H=n(4092),Z=n(42),q="x4Y1yYdR";const X=e=>{const{className:a,isLoading:n,readonly:r}=e,{t:t}=(0,o.B)(),l=(0,O.j)(),i=(0,T.d4)($.ed),d=(0,T.d4)(S),u=d?.id===i?.id,h=(0,s.useCallback)((()=>{l(z.setReadonly(!1))}),[l]),p=(0,s.useCallback)((()=>{!l(B()).then((e=>e?.payload))&&l(z.saveEdit())}),[l]),f=(0,s.useCallback)((()=>{l(z.cancelEdit())}),[l]),m=n?t("Профиль"):u?t("Ваш профиль"):`${t("Профиль пользоватея")} ${d?.username}`;return(0,c.jsxs)(x.z,{justify:"between",max:!0,className:a,children:[(0,c.jsx)(x.z,{gap:"16",children:(0,c.jsx)(v.EY,{title:m})}),u&&(r?(0,c.jsx)(Z.$n,{disabled:n,onClick:h,theme:Z.Ox.OUTLINE,children:(0,c.jsxs)(x.z,{gap:"16",children:[(0,c.jsx)(H.A,{className:(0,g.x)(q,{},["sJaGHSeQ"])}),t("Редактировать")]})}):(0,c.jsxs)(x.z,{className:"BsqCiksP",gap:"32",children:[(0,c.jsx)(Z.$n,{disabled:n,onClick:p,theme:Z.Ox.OUTLINE_GREEN,children:(0,c.jsxs)(x.z,{gap:"16",children:[(0,c.jsx)(W,{className:(0,g.x)(q,{},["XSNQO4TY"])}),t("Сохранить")]})}),(0,c.jsx)(Z.$n,{disabled:n,onClick:f,theme:Z.Ox.OUTLINE_RED,children:(0,c.jsxs)(x.z,{gap:"16",children:[(0,c.jsx)(K,{className:(0,g.x)(q,{},["FniuUHM5"])}),t("Отменить")]})})]}))]})},J={profile:Y},Q=(0,s.memo)((e=>{const{className:a,profileId:n,setProfileNotFound:t}=e,{t:l}=(0,o.B)(),i=(0,O.j)(),d=(0,T.d4)(A),u=(0,T.d4)(w),h=(0,T.d4)(_),p=(0,T.d4)(k),g=(0,T.d4)(I);u&&t?.(!0);const f={[r.INCORRECT_AGE]:l("Неккоректный возраст"),[r.INCORRECT_CITY]:l("Неккоректный регион"),[r.INCORRECT_USER_DATA]:l("Имя и фамилия обязательны"),[r.NO_DATA]:l("Данные не указаны"),[r.SERVER_ERROR]:l("Ошибка сервера")};(0,b.m)((()=>i(P(n))));const m=(0,s.useCallback)((e=>{i(z.updateProfile({firstname:e||""}))}),[i]),C=(0,s.useCallback)((e=>{i(z.updateProfile({lastname:e||""}))}),[i]),R=(0,s.useCallback)((e=>{i(z.updateProfile({age:0|Number(e)}))}),[i]),j=(0,s.useCallback)((e=>{i(z.updateProfile({city:e||""}))}),[i]),y=(0,s.useCallback)((e=>{i(z.updateProfile({username:e||""}))}),[i]),S=(0,s.useCallback)((e=>{i(z.updateProfile({avatar:e||""}))}),[i]),L=(0,s.useCallback)((e=>{i(z.updateProfile({currency:e}))}),[i]),U=(0,s.useCallback)((e=>{i(z.updateProfile({country:e}))}),[i]);return(0,c.jsx)(N.H,{reducers:J,children:(0,c.jsxs)(x.T,{gap:"32",max:!0,className:a,children:[!u&&(0,c.jsx)(X,{isLoading:h,readonly:p}),g?.length&&g.map((e=>(0,c.jsx)(v.EY,{theme:v.$G.ERROR,text:f[e]},e))),(0,c.jsx)(E,{data:d,isLoading:h,error:u,readonly:p,onChangeFirstname:m,onChangeLastname:C,onChangeAge:R,onChangeCity:j,onChangeUsername:y,onChangeAvatar:S,onChangeCurrency:L,onChangeCountry:U})]})})}));var ee=n(6314);const ae=(0,s.lazy)((()=>n.e(640).then(n.bind(n,1640)))),ne=e=>(0,c.jsx)(s.Suspense,{fallback:(0,c.jsx)(ee.E,{width:"100%",height:140}),children:(0,c.jsx)(ae,{...e})}),re=(0,s.lazy)((()=>n.e(872).then(n.bind(n,1872)))),te=e=>(0,c.jsx)(s.Suspense,{fallback:(0,c.jsx)(ee.E,{width:"100%",height:120}),children:(0,c.jsx)(re,{...e})});var le=n(657),se=n(7767);const oe=()=>{const{id:e}=(0,se.g)(),[a,n]=(0,s.useState)(!1);return e?(0,c.jsx)(le.YW,{children:(0,c.jsxs)(x.T,{max:!0,gap:"32",children:[!a&&(0,c.jsx)(ne,{profileId:e}),(0,c.jsx)(Q,{setProfileNotFound:n,profileId:e}),!a&&(0,c.jsx)(te,{profileId:e})]})}):null};var ce=(0,s.memo)(oe)},8623:function(e,a,n){n.d(a,{H:function(){return s}});var r=n(6540),t=n(1338),l=n(4848);const s=e=>{const{children:a,reducers:n,removeAfterRemount:s=!0}=e,o=(0,t.wA)(),c=(0,t.Pj)();return(0,r.useEffect)((()=>{const e=c.reducerManager.getReducerMap();if(Object.entries(n).forEach((a=>{let[n,r]=a;n in e||(c.reducerManager.add(n,r),o({type:`@INIT ${n} reducer`}))})),s)return()=>{Object.entries(n).forEach((e=>{let[a]=e;c.reducerManager.remove(a),o({type:`@DESTROY ${a} reducer`})}))}}),[o,s,n,c.reducerManager]),(0,l.jsx)(l.Fragment,{children:a})}}}]);